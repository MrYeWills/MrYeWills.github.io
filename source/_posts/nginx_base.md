---
title: nginx笔记
date: 2021/6/22
tags: nginx
categories: 
- 前端工具
series: nginx
---

## 基础知识
### 静态服务器和反向代理
nginx是一款静态服务器，可以自行处理客户端静态资源如js、css 等等的返回；
nginx并不能处理动态资源接口，所有的动态接口，如商品价格、库存量 等请求 都转发给 业务服务器，由业务服务器 返回给nginx，再由nginx返回给客户端。
这个过程中nginx起到一个代理的作用，上面的过程也是 nginx 反向代理的过程；
nginx 最重要的两个功能就是 静态服务器 和 反向代理；
其他的如负载均衡（当nginx作为代理时，当有多台服务器时，nginx如何将请求均衡发给多台服务器，达到负载均衡 性能优化），都是因此延伸出来。
![](/image/nginx/busi.png)
另外可参考《一个http请求的全流程》图片看反向代理。

反向代理其实就是 转发代理。

### nginx相比apache的优势
apache是上一代服务器(当时的cpu也是单核的，apache也是根据这个单核cpu设计的,这个理由只当看看)，产生比较早，特点如下：
- 一个进程处理一个请求；
- 阻塞式的

nginx是最新一代服务器(根据当代多核cpu设计的,这个理由只当看看)，特点如下：
- 一个进程处理多个请求
- 非阻塞式的

因为以上两个特点，nginx也具有了高并发能力

###  nginx产生和流行的原因
互联网快速增长，高并发需求大，apache处理请求的低效性，导致了nginx 这种能高并发服务器的产生。


### 有关http请求相关
#### 一个http请求的全流程
如下：
- 请求发送到nginx，nginx响应静态资源；
- 动态请求，nginx作为反向代理：将请求发送给 应用服务器（就是后端人员写的服务器），再有应用服务器响应nginx，由nginx返回客户端。
- 应用服务器 接受请求后，请求DB 数据库服务器，对数据库进行增删改查，由数据库服务器响应最新数据给应用服务器。
![](/image/nginx/http.jpg)

#### nginx处理请求过程
对于下图说明：
- 静态服务器：公司通过在本地建立一个资源目录库，用于返回静态资源
- 大中型公司才会将 应用服务和数据库服务器进行分离，一般应用通常将应用服务器和数据库服务器放在同一个机器上，不用做数据库与应用服务器的分离；
- 静态资源响应很快，通常一段时间内能处理5万个请求，但一个动态请求因为要走反向代理 到 应用服务器 到数据库服务器 所以可能只能处理5000条数据，因此就有了性能优化的需求：
  - 比如 反向代理的时候，在nginx这里做缓存处理，相同的请求直接缓存返回，不需要往下请求，达到加速；
  - 当公司有多个应用服务器时，nginx不要将所有请求发送到一台机器，通过算法均衡发送，达到负载均衡；

- 数据库旁边的缓存服务，也是用于加速的服务器，可以不部署。

![](/image/nginx/http1.jpg)



